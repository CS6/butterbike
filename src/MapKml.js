import React from 'react';
import { StyleSheet, View, Text, Dimensions } from 'react-native';
import MapView, { Overlay, OverlayComponent, Marker, Circle, Polyline, Polygon } from 'react-native-maps';
import Geojson from 'react-native-geojson';

const { width, height } = Dimensions.get('window');

const ASPECT_RATIO = width / height;
const destination = { latitude: 24.147782, longitude: 120.673492 }

const LATITUDE_TW = 24.147782;
const LONGITUDE_TW = 120.673492;
const LATITUDE = -18.9193508;
const LONGITUDE = -48.2830592;
const LATITUDE_DELTA = 0.0922;
const LONGITUDE_DELTA = LATITUDE_DELTA * ASPECT_RATIO;
// const KML_FILE = 'https://pastebin.com/raw/jAzGpq1F';
const KML_FILE = './TaiwanCyclingRoutes.kml';

const GOOGLE_MAPS_APIKEY = 'AIzaSyC8Yg8Ig6VEZIWz8cWH3yfYOjAGzqIpDMI';

// type KmlContainer {
//         markers: [Marker]
//       }

const alcatraz = {
        type: 'FeatureCollection',
        features: [
                {
                        type: 'Feature',
                        properties: {},
                        geometry: {
                                type: 'LineString',
                                coordinates: [
                                        [-122.42305755615234, 37.82687023785448],
                                        [-123.42305755615234, 47.82687023785448],
                                        [-122.42305755615234, 37.82687023785448],
                                        [120.97007, 24.80412],
                                        [120.97006, 24.80415],
                                        [120.97005, 24.80417],
                                        [120.97005, 24.80419],
                                        [120.97004, 24.80422],
                                        [120.97005, 24.80427],
                                        [120.97006, 24.80429],
                                        [120.97007, 24.8043],
                                        [120.97009, 24.80433],
                                        [120.97012, 24.80437],
                                        [120.97017, 24.8044],
                                        [120.97022, 24.80443],
                                        [120.97027, 24.80446],
                                        [120.96974, 24.80515],
                                        [120.96953, 24.80541],
                                        [120.96913, 24.80592],
                                        [120.96863, 24.80659],
                                        [120.96824, 24.80712],
                                        [120.96774, 24.80773],
                                        [120.96729, 24.80832],
                                        [120.96699, 24.80871],
                                        [120.96678, 24.80897],
                                        [120.96647, 24.80938],
                                        [120.96609, 24.80988],
                                        [120.96604, 24.80995],
                                        [120.96591, 24.8101],
                                        [120.96582, 24.81022],
                                        [120.96547, 24.81066],
                                        [120.96522, 24.811],
                                        [120.96487, 24.81148],
                                        [120.96473, 24.81166],
                                        [120.96447, 24.812],
                                        [120.96012,24.80921,24],
[120.96044,24.80941,24],
[120.96069,24.80958,25],
[120.96097,24.80978,25],
[120.96134,24.81,26],
[120.9619,24.81037,26],
[120.96198,24.81041,26],
[120.96209,24.81047,26],
[120.96255,24.81076,25],
[120.96286,24.81097,25],
[120.96355,24.81142,24],
[120.96383,24.8116,25],
[120.96447,24.812,24],
[120.96486,24.81225,24],
[120.96557,24.81272,23],
[120.96579,24.81287,22],
[120.96593,24.81296,22],
[120.96604,24.81302,23],
[120.96687,24.81355,24],
[120.96733,24.81383,24],
[120.96742,24.81388,24],
[120.96752,24.8139,24],
[120.96764,24.81391,24],
[120.96814,24.81393,23],
[120.969,24.81399,20],
[120.96915,24.81399,19],
[120.9696,24.81401,18],
[120.96992,24.81403,18],
[120.97005,24.81404,18],
[120.97087,24.81411,20],
[120.97251,24.81422,20],
[120.97267,24.81423,20],
[120.97426,24.81434,22],
[120.97472,24.81437,23],
[120.97562,24.81443,26],
[120.97666,24.8145,32],
[120.97687,24.81451,30],
[120.97693,24.81452,29],
[120.97695,24.81452,29],
[120.97806,24.81462,22],
[120.97915,24.81468,22],
[120.97973,24.81472,22],
[120.98031,24.81476,23],
[120.98088,24.8148,24],
[120.9812,24.81481,23],
[120.98176,24.81486,22],
[120.98242,24.81492,20],
[120.98289,24.81495,18],
[120.98416,24.81503,17],
[120.98506,24.81508,17],
[120.98529,24.81511,18],
[120.98543,24.81512,18],
[120.98587,24.81515,19],
[120.98734,24.81525,20],
[120.98844,24.81533,20],
[120.98897,24.81538,20],
[120.98916,24.81539,19],
[120.99158,24.81556,22],
[120.99164,24.81557,22],
[120.99188,24.81561,22],
[120.99239,24.81578,23],
[120.99284,24.81593,24],
[120.99313,24.81603,26],
[120.99318,24.81605,26],
[120.99326,24.81608,26],
[120.99336,24.81612,26],
[120.99349,24.8162,27],
[120.99354,24.81623,27],
[120.9936,24.81628,27],
[120.99369,24.8164,27],
[120.99406,24.81694,26],
[120.99438,24.81746,25],
[120.99505,24.81843,28],
[120.99524,24.81882,27],
[120.99528,24.81888,27],
[120.99536,24.81912,28],
[120.99546,24.81945,26],
[120.99559,24.81977,24],
[120.99562,24.81989,24],
[120.99571,24.82013,22],
[120.99576,24.82027,22],
[120.99584,24.82054,20],
[120.99599,24.821,18],
[120.99611,24.82133,16],
[120.99636,24.82208,15],
[120.99642,24.82229,15],
[120.99661,24.82298,15],
[120.99693,24.82417,15],
[120.99709,24.8249,19],
[120.99711,24.825,19],
[120.99714,24.82511,19],
[120.9972,24.82531,20],
[120.99721,24.82539,20],
[120.99729,24.82556,21],
[120.99731,24.82567,21],
[120.99745,24.82563,21],
[120.99777,24.82547,21],
[120.99825,24.82525,22],
[120.99829,24.82523,22],
[120.99899,24.82491,22],
[120.99911,24.82485,22],
[120.99926,24.82478,22],
[120.99932,24.82476,22],
[120.999322,24.82476,22],
[121.006057,24.82112,23],
[121.007425,24.82032,24],
[121.009005,24.819357,23],
[121.010197,24.81857,24],
[121.013653,24.816413,32],
[121.014986,24.815397,31],
[121.016006,24.814458,29],
[121.01779,24.81268,28],
[121.01806,24.81242,28],
[121.01817,24.81261,29],
[121.01834,24.81296,31],
[121.01913,24.81459,35],
[121.01936,24.81513,35],
[121.0194,24.8152,35],
[121.0198,24.81591,35],
[121.02004,24.81637,33],
[121.02031,24.81691,32],
[121.02061,24.81756,31],
[121.0209,24.81822,31],
[121.02114,24.81875,33],
[121.02131,24.81912,34],
[121.02134,24.8192,34],
[121.02158,24.81966,33],
[121.02179,24.82011,32],
[121.02203,24.82061,31],
[121.02226,24.82108,30],
[121.02249,24.82161,30],
[121.02255,24.82173,30],
[121.02259,24.82182,30],
[121.02264,24.82192,30],
[121.02302,24.82278,32],
[121.02346,24.82367,31],
[121.02403,24.82485,31],
[121.02439,24.82563,31],
[121.02485,24.82653,31],
[121.02499,24.82682,31],
[121.02568,24.8284,31],
[121.02593,24.82894,31],
[121.0266,24.83038,32],
[121.02671,24.83056,33],
[121.0268,24.83072,33],
[121.02683,24.83078,33],
[121.02689,24.83097,34],
[121.02693,24.83109,34],
[121.02697,24.83121,34],
[121.02699,24.83134,34],
[121.02701,24.83147,34],
[121.02701,24.83156,34],
[121.02701,24.83166,34],
[121.027,24.83178,34],
[121.02699,24.83188,35],
[121.026694,24.832864,32],
[121.026611,24.833385,33],
[121.02668,24.83411,31],
[121.02682,24.8341,32],
[121.02699,24.83408,33],
[121.02727,24.83405,34],
[121.02739,24.83402,35],
[121.02752,24.83398,36],
[121.02766,24.83392,36],
[121.02778,24.83386,36],
[121.0279,24.83379,36],
[121.02823,24.83361,38],
[121.02839,24.83353,38],
[121.02921,24.83309,37],
[121.03101,24.83212,34],
[121.0311,24.83208,34],
[121.03134,24.83195,34],
[121.03183,24.83168,34],
[121.0322,24.83147,34],
[121.03233,24.8314,34],
[121.03242,24.83137,35],
[121.03251,24.83133,35],
[121.03266,24.8313,35],
[121.03292,24.83126,35],
[121.03297,24.83125,35],
[121.03341,24.8312,35],
[121.03367,24.83117,35],
[121.03449,24.83109,35],
[121.03474,24.83106,34],
[121.037124,24.830699,35],
[121.03712,24.8307,35],
[121.03789,24.83056,37],
[121.03821,24.83051,38],
[121.03907,24.83038,38],
[121.04032,24.83021,38],
[121.04076,24.83014,39],
[121.04133,24.83005,39],
[121.0423,24.82987,37],
[121.04258,24.8298,37],
[121.0428,24.8297,37],
[121.043,24.82953,38],
[121.04319,24.82934,39],
[121.04322,24.82932,39],
[121.04336,24.82919,39],
[121.04363,24.82896,40],
[121.04402,24.82877,39],
[121.04557,24.82822,37],
[121.04708,24.82775,37],
[121.0482,24.82745,38],
[121.04833,24.82742,38],
[121.04869,24.82734,39],
[121.05171,24.82666,42],
[121.0535,24.82627,43],
[121.05409,24.82614,43],
[121.05434,24.82608,43],
[121.05559,24.82581,48],
[121.05723,24.82545,50],
[121.0574,24.82542,50],
[121.05917,24.82502,47],
[121.05953,24.82495,47],
[121.0598,24.82489,47],
[121.06064,24.82471,45],
[121.06079,24.82468,45],
[121.06121,24.82458,45],
[121.06138,24.82456,46],
[121.06146,24.82455,46],
[121.06155,24.82456,46],
[121.06165,24.82456,46],
[121.0621,24.82465,46],
[121.0643,24.82529,48],
[121.06437,24.82532,48],
[121.064374,24.825313,48],
[121.065079,24.825491,47],
[121.067405,24.826776,48],
[121.0674,24.82678,48],
[121.06775,24.82698,49],
[121.06798,24.8271,50],
[121.06831,24.827,50],
[121.06874,24.82687,50],
[121.06915,24.82671,50],
[121.06969,24.82651,48],
[121.07007,24.82637,48],
[121.07064,24.82619,49],
[121.0713,24.82598,49],
[121.07177,24.82586,49],
[121.07202,24.8258,50],
[121.07221,24.82575,50],
[121.07241,24.8257,50],
[121.07278,24.82565,50],
[121.07436,24.82548,51],
[121.07443,24.82547,51],
[121.07483,24.82541,52],
[121.07515,24.82534,53],
[121.07568,24.82522,54],
[121.07584,24.82517,54],
[121.07639,24.82504,55],
[121.0765,24.82501,55],
[121.07654,24.825,55],
[121.07696,24.8249,56],
[121.07712,24.82487,56],
[121.0773,24.82486,57],
[121.07745,24.82485,57],
[121.07768,24.82483,57],
[121.07805,24.82481,56],
[121.07855,24.82476,55],
[121.07895,24.82471,55],
[121.08016,24.82457,54],
[121.08022,24.82486,54],
[121.08029,24.82515,55],
[121.08042,24.82568,57],
[121.08044,24.82579,57],
[121.08047,24.82594,58],
[121.08052,24.82616,59],
[121.08054,24.82645,61],
[121.08065,24.82681,63],
[121.08079,24.82702,64],
[121.08112,24.82745,65],
[121.08126,24.82789,67],
[121.08134,24.82801,67],
[121.08153,24.82827,69],
[121.082089,24.828737,74],
[121.08209,24.82874,74],
[121.08231,24.82892,75],
[121.08271,24.82922,76],
[121.08284,24.82932,77],
[121.083,24.82943,77],
[121.08339,24.82968,77],
[121.08428,24.83025,78],
[121.08438,24.83032,79],
[121.0846,24.83046,79],
[121.08471,24.83052,80],
[121.0848,24.83056,80],
[121.08493,24.8306,80],
[121.08541,24.8307,80],
[121.08712,24.83118,76],
[121.08784,24.83136,77],
[121.08848,24.83151,78],
[121.08921,24.83175,80],
[121.08959,24.83189,80],
[121.08979,24.83198,79],
[121.09023,24.83214,78],
[121.09044,24.83224,78],
[121.0905,24.83228,78],
[121.0912,24.83273,77],
[121.09175,24.83308,77],
[121.09176,24.83309,77],
[121.09199,24.83324,77],
[121.09211,24.83332,77],
[121.09238,24.83354,77],
[121.09251,24.83365,78],
[121.09271,24.83381,78],
[121.09285,24.8339,78],
[121.09323,24.83412,78],
[121.09336,24.83419,78],
[121.09356,24.83432,78],
[121.09382,24.83453,79],
[121.09405,24.83473,79],
[121.09419,24.83484,80],
[121.09431,24.83493,79],
[121.09454,24.83506,79],
[121.09484,24.83528,78],
[121.09496,24.83538,78],
[121.09506,24.83549,78],
[121.09515,24.8356,78],
[121.09529,24.83579,78],
[121.09641,24.83736,82],
[121.0965,24.8375,82],
[121.09659,24.83764,82],
[121.09667,24.83776,82],
[121.09675,24.83787,82],
[121.09682,24.83795,82],
[121.09688,24.83802,82],
[121.09698,24.83814,82],
[121.09702,24.83818,82],
[121.0971,24.83825,82],
[121.09729,24.83838,81],
[121.09737,24.83843,81],
[121.09741,24.83845,81],
[121.09744,24.83846,81],
[121.09753,24.83851,81],
[121.09777,24.83861,79],
[121.0981,24.83876,77],
[121.09821,24.8388,76],
[121.09846,24.83889,75],
[121.09885,24.83903,75],
[121.09918,24.83912,75],
[121.09925,24.83914,75],
[121.09933,24.83916,75],
[121.09947,24.83919,76],
[121.09956,24.83921,76],
[121.09966,24.83922,77],
[121.09974,24.83923,77],
[121.09984,24.83923,77],
[121.10001,24.83923,78],
[121.1003,24.83922,79],
[121.10184,24.83915,81],
[121.10304,24.8391,84],
[121.10323,24.83909,85],
[121.10448,24.83905,89],
[121.10475,24.83904,89],
[121.10513,24.83903,91],
[121.10522,24.83902,91],
[121.10535,24.83902,92],
[121.10543,24.83901,92],
[121.10557,24.83899,93],
[121.10579,24.83896,94],
[121.10594,24.83892,96],
[121.10606,24.83889,97],
[121.10609,24.83887,97],
[121.10635,24.83879,100],
[121.10638,24.83878,100],
[121.10669,24.83868,103],
[121.10691,24.83862,105],
[121.10702,24.8386,105],
[121.10709,24.83859,105],
[121.10716,24.83859,106],


                                ]
                                //       coordinates: [-123.42305755615234, 47.82687023785448],


                        }
                }
        ]
};

class MapKml extends React.Component {
        constructor(props) {
                super(props);

                this.state = {
                        region: {
                                latitude: LATITUDE,
                                longitude: LONGITUDE,
                                latitudeDelta: LATITUDE_DELTA,
                                longitudeDelta: LONGITUDE_DELTA,
                        },
                        region2: {
                                latitude: -17.9193508,
                                longitude: -48.2830592,
                                latitudeDelta: 0.0922,
                                longitudeDelta: LONGITUDE_DELTA,
                        },
                };

                this.onKmlReady = this.onKmlReady.bind(this);
        }

        onKmlReady() {
                this.map.fitToElements(true);
        }

        render() {
                return (
                        <View style={styles.container}>
                                <MapView
                                        ref={ref => {
                                                this.map = ref;
                                        }}
                                        provider={"google"}

                                        //   provider={this.props.provider}
                                        style={styles.map}
                                        initialRegion={this.state.region}
                                        kmlSrc={KML_FILE}
                                        onKmlReady={this.onKmlReady}
                                >
                                        <Geojson geojson={alcatraz} />

                                        <Marker
                                                coordinate={this.state.region}
                                                title="Test"
                                                description="Test"
                                        >
                                                <View style={{ backgroundColor: "#F0F", padding: 10 }}>
                                                        <Text>AO</Text>
                                                </View>
                                        </Marker>

                                        <Marker coordinate={this.state.region2}>
                                                <View style={{ backgroundColor: "red", padding: 10 }}>
                                                        <Text>SF</Text>
                                                </View>
                                        </Marker>

                                        <Marker
                                                coordinate={this.state.region2}
                                                title="Test"
                                                description="Test"
                                        />
                                        <Marker
                                                coordinate={{ latitude: Number(LATITUDE_TW), longitude: Number(LONGITUDE_TW) }}
                                        // coordinate={{latitude: 24.147782, longitude: 120.673492 }}

                                        />
                                </MapView>
                        </View>
                );
        }
}

MapKml.propTypes = {
        provider: MapView.ProviderPropType,
};

const styles = StyleSheet.create({
        container: {
                justifyContent: 'flex-end',
                alignItems: 'center',
        },
        scrollview: {
                alignItems: 'center',
                paddingVertical: 40,
        },
        map: {
                width,
                height,
        },
});

module.exports = MapKml;